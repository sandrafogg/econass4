---
title: "Appendix"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include = FALSE, echo = FALSE}
#Load Packages
library(tidyverse)
library(knitr)
library(stargazer)

#Laod the Data Set
mc_carbon_df <- read_csv("HW4Data.csv")
mc_carbon_df

#Notes About Data
#Current carbon emissions in the sectors are: (A=180, B=200, C=220, and D=300).
#Sectors A, B, and C are in country X. Sector D is in a different country, Y.
#Prices are in $/ton and quantities are in tons.

```

###Create a Function for Marginal Abatement Cost of Sector "A"
```{r, include = FALSE}
#Create Function with Linear Regression
#Plot the Points and Regression Line
paris_plotA <- ggplot(mc_carbon_df, aes(x = mc_carbon_df$Abatement, y = mc_carbon_df$MC_A)) + geom_point() + geom_smooth(method = "lm")
paris_plotA

#Find the Equation of the Line
paris_modelA <- lm(MC_A ~ Abatement, data = mc_carbon_df)
coef(paris_modelA)

# Intercept for Sector "A"
int_a <- -8.6444767

#Slope for Sector "A"
slope_a <- 0.5768419

```
Equation for Sector "A"
$$Marginal~Abatement~Cost(A) = -8.6444767 + 0.5768419(Tons~of~Abatement)$$



###Create a Function for Marginal Abatement Cost of Sector "B"
```{r, include=FALSE}
#Create Function with Linear Regression
#Plot the Points and Regression Line
paris_plotB <- ggplot(mc_carbon_df, aes(x = mc_carbon_df$Abatement, y = mc_carbon_df$MC_B)) + geom_point() + geom_smooth(method = "lm")
paris_plotB

#Find the Equation of the Line
paris_modelB <- lm(MC_B ~ Abatement, data = mc_carbon_df)
coef(paris_modelB)


#Intercept for Sector "B"
int_b <- 9.3176977

#Slope for Sector "B"
slope_b <- 0.1987443 

```

Equation for Sector "B"
$$Marginal~Abatement~Cost(B) = 9.3176977 + 0.1987443(Tons~of~Abatement)$$


###Create a Function for Marginal Abatement Cost of Sector "C"
```{r, include = FALSE}
#Create Function with Linear Regression
#Plot the Points and Regression Line
paris_plotC <- ggplot(mc_carbon_df, aes(x = mc_carbon_df$Abatement, y = mc_carbon_df$MC_C)) + geom_point() + geom_smooth(method = "lm")
paris_plotC

#Find the Equation of the Line
paris_modelC <- lm(MC_C ~ Abatement, data = mc_carbon_df)
coef(paris_modelC)

# Intercept for Sector "C"
int_c <- -11.6550307 

#Slope for Sector "C"
slope_c <- 0.7838266

```
Equation for Sector "C"
$$Marginal~Abatement~Cost(C) = -11.6550307 + 0.7838266(Tons~of~Abatement)$$

###Create a Function for Marginal Abatement Cost of Sector "D"
```{r, include = FALSE}
#Create Function with Linear Regression
#Plot the Points and Regression Line
paris_plotD <- ggplot(mc_carbon_df, aes(x = mc_carbon_df$Abatement, y = mc_carbon_df$MC_D)) + geom_point() + geom_smooth(method = "lm")
paris_plotD

#Find the Equation of the Line
paris_modelD <- lm(MC_D ~ Abatement, data = mc_carbon_df)
coef(paris_modelD)

# Intercept for Sector "D"
int_d <- 9.6875061

#Slope for Sector "D"
slope_d <- 0.2599275

```
Equation for Sector "D"
$$Marginal~Abatement~Cost(D) = 9.6875061 + 0.2599275(Tons~of~Abatement)$$


```{r, echo = FALSE, message = FALSE, include = FALSE}
#Create a "tidy" Data Frame
colnames(mc_carbon_df) <- c("Abatement", "A", "B", "C", "D")

carbon_tidy <- mc_carbon_df %>% 
  gather(Sector, Price, A:D) 
```

###Create a Plot for All of the Sectors
```{r, echo = FALSE, warning = FALSE, message = FALSE}
#Create a Plot of All Sectors

paris_plot_all <- ggplot(carbon_tidy, aes(x = Abatement, y = Price)) + geom_point() + geom_smooth(method = "lm", title = "Marginal Abatement Costs by Sector", color = "red4") + facet_wrap(~Sector) + theme_classic() + ggtitle("Marginal Abatement Costs by Sector")

paris_plot_all

```


####Create a Table of Regression Results
```{r, message = FALSE, echo = FALSE, warning = FALSE}
regression_results <- stargazer(paris_modelA, paris_modelB, paris_modelC, paris_modelD, type="text", title="Table 1: Marginal Abatement Cost Regression Results")

```


###Derive Demand Curves and WTP at Current Levels of Emissions 
```{r, include = FALSE}
#Marginal Abatement Costs at Current Emissions
mccurrent_A <- -8.6444767 + (0.5768419*180)
mccurrent_B <- 9.3176977 + (0.1987443*200)
mccurrent_C <- -11.6550307 + (0.7838266*220)
mccurrent_D <- 9.6875061 + (0.2599275*300)


#WTP for the First Unit 
mccurrent_A #$95.18707
mccurrent_B #$49.06656
mccurrent_C #$160.7868
mccurrent_D #$87.66576




(mccurrent_A-0)/0.5768419
(mccurrent_B-0)/0.1987443
(mccurrent_C-0)/0.7838266
(mccurrent_D-0)/0.2599275



```

Sector C is Willing to Pay the Most for Abatement

```{r, include = FALSE}
#Derive Demand Curve of Sector A

# Use Quantities from 0 to 180 by 5 to Estimate a Demand Curve
vector_demand_A <- seq(0,180,by=5)
# Write function for demand curve for Sector A
demand_A_function <- function(x){(slope_a*(180-x)) + int_a}


# Derive demand curve using the values above
demand_A <- demand_A_function(vector_demand_A)
demand_A

# Graph it to see if this worked....
demand_A_gph <- curve(demand_A_function, from=0, to=180, xlab = "x", ylab = "y")

#Derive Demand Curve of Sector B

# Use Quantities from 0 to 200 by 5 to Estimate a Demand Curve
vector_demand_B <- seq(0,200,by=5)
# Write function for demand curve for Sector A
demand_B_function <- function(x){(slope_b*(200-x)) + int_b}


# Derive demand curve using the values above
demand_B <- demand_B_function(vector_demand_B)
demand_B

# Graph it to see if this worked....
demand_B_gph <- curve(demand_B_function, from=0, to=200, xlab = "x", ylab = "y")

#Derive Demand Curve of Sector C

# Use Quantities from 0 to 220 by 5 to Estimate a Demand Curve
vector_demand_C <- seq(0,220,by=5)
# Write function for demand curve for Sector A
demand_C_function <- function(x){(slope_c*(220-x)) + int_c}


# Derive demand curve using the values above
demand_C <- demand_C_function(vector_demand_C)
demand_C

# Graph it to see if this worked....
demand_C_gph <- curve(demand_C_function, from=0, to=220, xlab = "x", ylab = "y")

#Derive Demand Curve of Sector D

# Use Quantities from 0 to 300 by 5 to Estimate a Demand Curve
vector_demand_D <- seq(0,300,by=5)
# Write function for demand curve for Sector A
demand_D_function <- function(x){(slope_d*(300-x)) + int_d}


# Derive demand curve using the values above
demand_D <- demand_D_function(vector_demand_D)
demand_D

# Graph it to see if this worked....
demand_D_gph <- curve(demand_D_function, from=0, to=300, xlab = "x", ylab = "y")




#Find all new Demand Curves at Current Level
#Use new points to find new slopes


slope_a #-0.5768419
slope_b #-0.2453285
slope_c #-0.7308526
slope_d #-0.2922217

mccurrent_A #$95.18707 or intercept
mccurrent_B #$49.06656 or intercept
mccurrent_C #$160.7868 or intercept
mccurrent_D #$87.66576 or intercept

```

###Graph all Demand Curves
```{r, message = FALSE, echo = FALSE, warning=FALSE}
demand_plot <- ggplot(data.frame(x = c(0, 350))) + 
  stat_function(fun = demand_A_function, aes(color = "A")) +
  stat_function(fun = demand_B_function, aes(color = "B")) +
  stat_function(fun = demand_C_function, aes(color = "C")) +
  stat_function(fun = demand_D_function, aes(color = "D")) +
  scale_y_continuous(limits= c(-12,170), expand = c(0,0)) +
  scale_x_continuous(limits= c(0, 400), expand = c(0,0)) + 
  labs(fill = "", color = "Sectors") + 
  xlab("\n Carbon Abatement (ton)") + 
  ylab("Marginal Cost \n($/ton) \n") + 
  theme_classic() +
  ggtitle("Demand: Marginal Cost of Abatement\n") +
  theme(plot.title = element_text(hjust = 0.5),
        axis.title.y = element_text(angle=0, hjust = 0.5, vjust = 0.5)) 
demand_plot




```

$$MC_A = -0.5768419(Emissions) + 95.18707$$
$$MC_B = -0.2453285(Emissions) + 49.06656 $$
$$MC_C = -0.7308526Emissions) + 160.7868 $$
$$MC_D = -0.2922217(Emissions)+ 87.66576 $$

###Cutting Carbon Emissions in Half
####Policy Option 1: Cap on Carbon
```{r}
# Create a Data Frame for Abatement
abate_df <-c(100, 100, 100, 300)

#Calculate Marginal Cost of Abatement of 100 tons
MC_100_A<-(-slope_a*100) + int_a 
MC_100_B<-(slope_b*100) + int_b
MC_100_C<-(slope_c*100) + int_c

MC_100_countryX <- rbind(MC_100_A, MC_100_B, MC_100_C, NA)
MC_100_countryX

#Find the Area Under the Curve to Find the Total Cost of Each Sector
Cost_A<-(MC_100_A*100)+(100*(int_a-MC_100_A)*0.5)
Cost_B<-(MC_100_B*100)+(100*(int_b-MC_100_B)*0.5)
Cost_C<-(MC_100_C*100)+(100*(int_c-MC_100_C)*0.5)

#Find the Total Cost of Abatement
Total_Cost <- sum(Cost_A, Cost_B, Cost_C)
Total_Costs_df <- rbind(Cost_A, Cost_B, Cost_C, Total_Cost)

Total_Costs_Abatement_df <- cbind(abate_df, MC_100_countryX, Total_Costs_df) 

colnames(Total_Costs_Abatement_df) = c("Tons Abated","Marginal Cost","Total Cost")

row.names(Total_Costs_Abatement_df) =c("Sector A", "Sector B", "Sector C", "Country X Total")

Total_Costs_Abatement_df

```






```{r}
#Cut Carbon by 100 in Sectors A, B, C 
#Use Quantities from 0 to 80 by 5 to Estimate a Demand Curve
vector_demand_A_h <- seq(0,180,by=5)

# Write function for demand curve for Sector A
demand_A_function_h <- function(x){(slope_a*(80-x)) + int_a}


# Derive Demand Curve Using the Values 
demand_A_h <- demand_A_function_h(vector_demand_A_h)
demand_A_h

# Graph it
demand_A_gph_h <- curve(demand_A_function_h, from=0, to=80, xlab = "x", ylab = "y")

#Derive Demand Curve of Sector B

# Use Quantities from 0 to 100 by 5 to Estimate a Demand Curve
vector_demand_B_h <- seq(0,100,by=5)
# Write function for demand curve for Sector A
demand_B_function_h <- function(x){(slope_b*(100-x)) + int_b}


# Derive Demand Curve Using the Values 
demand_B_h <- demand_B_function_h(vector_demand_B_h)
demand_B_h
# Graph it
demand_B_gph_h <- curve(demand_B_function_h, from=0, to=100, xlab = "x", ylab = "y")

#Derive Demand Curve of Sector C

# Use Quantities from 0 to 120 by 5 to Estimate a Demand Curve
vector_demand_C_h <- seq(0,120,by=5)
# Write function for demand curve for Sector A
demand_C_function_h <- function(x){(slope_c*(120-x)) + int_c}


# Derive Demand Curve Using the Values 
demand_C_h <- demand_C_function_h(vector_demand_C_h)
demand_C_h

# Graph it
demand_C_gph_h <- curve(demand_C_function_h, from=0, to=120, xlab = "x", ylab = "y")

#Marginal Abatement Costs at 100 Less Emissions
mch_A <- -8.6444767 + (0.5768419*80)
mch_B <- 9.3176977 + (0.1987443*100)
mch_C <- -11.6550307 + (0.7838266*120)



#WTP for the First Unit 
mch_A #$37.50288
mch_B #$29.19213
mch_C #$82.40416

#Sector C Still Willing to Pay More



```

